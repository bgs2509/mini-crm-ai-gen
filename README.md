<div align="center">

# üöÄ –ú–∏–Ω–∏-CRM: –ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∑–∞–∏–º–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è–º–∏ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏

–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –≤–∞–∫–∞–Ω—Å–∏–∏ **Senior Python Backend Developer**.

üìã **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ**: [docs/senior-python-crm-assignment.md](docs/senior-python-crm-assignment.md)

---

</div>

## üìä –û –ø—Ä–æ–µ–∫—Ç–µ

Production-ready CRM —Å–∏—Å—Ç–µ–º–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π (multi-tenancy), –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ **FastAPI**, **PostgreSQL 15+** –∏ **SQLAlchemy 2.0**.

### üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

<table>
<tr>
<td width="50%">

**–ö–æ–¥–æ–≤–∞—è –±–∞–∑–∞:**
- üêç **79** —Ñ–∞–π–ª–æ–≤ Python
- üìÅ **16** –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- üìù **13,571** —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- ‚úÖ **100%** –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π

**API:**
- üîå **32** —ç–Ω–¥–ø–æ–π–Ω—Ç–∞
- üìä 13 GET, 10 POST, 4 PATCH, 4 DELETE, 1 PUT
- üìö –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ API (`/api/v1`)
- üìñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è OpenAPI/Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

</td>
<td width="50%">

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- üß™ **3** —Ñ–∞–π–ª–∞ unit-—Ç–µ—Å—Ç–æ–≤
- üî¨ **8** —Ñ–∞–π–ª–æ–≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- üéØ **1** E2E —Ç–µ—Å—Ç
- ‚ú® **–í—Å–µ–≥–æ: 186 —Ç–µ—Å—Ç–æ–≤**

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:**
- ‚ö° FastAPI 0.104, Python 3.11+
- üóÑÔ∏è PostgreSQL 15+, SQLAlchemy 2.0
- üîê JWT (python-jose), bcrypt
- üßπ mypy, black, ruff, isort
- üê≥ Docker, Docker Compose

</td>
</tr>
</table>

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
git clone git@github.com:bgs2509/mini-crm-ai-gen.git && cd mini-crm-ai-gen
cp .env.example .env

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å Docker
docker-compose up -d

# 3. –û—Ç–∫—Ä—ã—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API
# http://localhost:8000/docs
```

> üí° **–ì–æ—Ç–æ–≤–æ!** API –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:8000` ‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `/docs`

---

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (access/refresh —Ç–æ–∫–µ–Ω—ã)
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt)
- Role-Based Access Control (RBAC) —Å 4 —É—Ä–æ–≤–Ω—è–º–∏ —Ä–æ–ª–µ–π:
  - **Owner** (–í–ª–∞–¥–µ–ª–µ—Ü) - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º—É
  - **Admin** (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π
  - **Manager** (–ú–µ–Ω–µ–¥–∂–µ—Ä) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏
  - **Member** (–£—á–∞—Å—Ç–Ω–∏–∫) - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–≤–æ–∏–º –¥–∞–Ω–Ω—ã–º
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –æ—à–∏–±–æ–∫:
  - 400 (–≤–∞–ª–∏–¥–∞—Ü–∏—è), 401 (–Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω), 403 (–Ω–µ—Ç –ø—Ä–∞–≤)
  - 404 (–Ω–µ –Ω–∞–π–¥–µ–Ω–æ), 409 (–∫–æ–Ω—Ñ–ª–∏–∫—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏)

### üè¢ Multi-tenancy (–ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∞—Ä–µ–Ω–¥–∞)
- –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Organization-Id`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

### üìá –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
- –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏ email
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–ª–∞–¥–µ–ª—å—Ü—É
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ó–∞—â–∏—Ç–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è: –Ω–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ —Å–¥–µ–ª–∫–∞–º–∏ (409 Conflict)

### üíº –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∞–º–∏ (Deals)
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∞–º–∏
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Å—Ç–∞–¥–∏–∏ –≤–æ—Ä–æ–Ω–∫–∏ –ø—Ä–æ–¥–∞–∂ (pipeline stages)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ (–Ω–æ–≤–∞—è, –≤ —Ä–∞–±–æ—Ç–µ, –≤—ã–∏–≥—Ä–∞–Ω–∞, –ø—Ä–æ–∏–≥—Ä–∞–Ω–∞)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤–∞–ª—é—Ç (USD, EUR, RUB)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º, —Å—É–º–º–∞–º, —Å—Ç–∞–¥–∏—è–º
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –ø–æ–ª—è–º
- –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞:
  - –ù–µ–ª—å–∑—è –∑–∞–∫—Ä—ã—Ç—å —Å–¥–µ–ª–∫—É –∫–∞–∫ "–≤—ã–∏–≥—Ä–∞–Ω–∞" —Å –Ω—É–ª–µ–≤–æ–π —Å—É–º–º–æ–π
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–π–º–ª–∞–π–Ω–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞
  - –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–µ–∂–¥—É —Å—Ç–∞–¥–∏—è–º–∏ (–∑–∞–ø—Ä–µ—Ç –æ—Ç–∫–∞—Ç–∞ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

### ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏
- –ü—Ä–∏–≤—è–∑–∫–∞ –∑–∞–¥–∞—á –∫ —Å–¥–µ–ª–∫–∞–º
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ä–æ–∫–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (due date)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è: –¥–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –ø—Ä–æ—à–ª–æ–º
- –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞: —É—á–∞—Å—Ç–Ω–∏–∫–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–≤–æ–∏—Ö —Å–¥–µ–ª–æ–∫

### üìù –¢–∞–π–º–ª–∞–π–Ω –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ —Å–¥–µ–ª–∫–µ
- –¢–∏–ø—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π:
  - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (comment)
  - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (status_changed)
  - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ (task_created)
  - –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (system)
- –•—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ JSONB (payload)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞

### üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã
- **–°–≤–æ–¥–∫–∞ –ø–æ —Å–¥–µ–ª–∫–∞–º** (`/analytics/deals/summary`):
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
  - –°—É–º–º–∞ —Å–¥–µ–ª–æ–∫ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
  - –°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –≤—ã–∏–≥—Ä–∞–Ω–Ω—ã—Ö —Å–¥–µ–ª–æ–∫
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö —Å–¥–µ–ª–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π
- **–í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂** (`/analytics/deals/funnel`):
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫ –ø–æ —Å—Ç–∞–¥–∏—è–º
  - –†–∞–∑–±–∏–≤–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
  - –†–∞—Å—á–µ—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –º–µ–∂–¥—É —Å—Ç–∞–¥–∏—è–º–∏
- In-memory –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üèóÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **–ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** (Clean Architecture):
  - –°–ª–æ–π API (—Ä–æ—É—Ç—ã, —Å—Ö–µ–º—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤)
  - –°–ª–æ–π —Å–µ—Ä–≤–∏—Å–æ–≤ (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
  - –°–ª–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ (–ø–∞—Ç—Ç–µ—Ä–Ω Repository)
  - –°–ª–æ–π –º–æ–¥–µ–ª–µ–π (ORM –º–æ–¥–µ–ª–∏)
- **Dependency Injection** —á–µ—Ä–µ–∑ FastAPI
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** (async/await)
- **–ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** —á–µ—Ä–µ–∑ Alembic
- **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** (type hints + Pydantic 2.x)
- **Docker-ready** —Å docker-compose

### üß™ –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ unit-—Ç–µ—Å—Ç—ã –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (–ø—Ä–∞–≤–∏–ª–∞, —Ä–æ–ª–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—è)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã API —á–µ—Ä–µ–∑ TestClient
- E2E —Ç–µ—Å—Ç—ã –ø–æ–ª–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –∞–Ω–∞–ª–∏—Ç–∏–∫–∞)
- Pytest —Ñ–∏–∫—Å—Ç—É—Ä—ã –¥–ª—è setup/teardown –ë–î
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ (mypy) –¥–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
- –õ–∏–Ω—Ç–µ—Ä—ã (ruff, black, isort) —Å pre-commit –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è OpenAPI/Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

<details open>
<summary><b>–í–∞—Ä–∏–∞–Ω—Ç 1: –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</b></summary>

<br>

**1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
```bash
git clone <repository-url>
cd mini-crm-ai-gen
```

**2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
cp .env.example .env
```

**3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`**
```env
SECRET_KEY=your-secure-secret-key-minimum-32-characters
POSTGRES_PASSWORD=your-secure-password
```

**4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
```bash
docker-compose up -d
```

> ‚ÑπÔ∏è –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

**5. –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é**

| –°–µ—Ä–≤–∏—Å | URL |
|--------|-----|
| üåê API | http://localhost:8000 |
| üìö Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | http://localhost:8000/docs |
| üìñ ReDoc –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | http://localhost:8000/redoc |

</details>

<details>
<summary><b>–í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞</b></summary>

<br>

**1. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**
```bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

**2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
```bash
pip install -r requirements.txt
```

**3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å PostgreSQL**
```bash
createdb crm_db
```

**4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env —Ñ–∞–π–ª
```

**5. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏**
```bash
alembic upgrade head
```

**6. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
```bash
uvicorn app.main:app --reload
```

</details>

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **Python:** 3.11+
- **PostgreSQL:** 15+
- **Docker & Docker Compose:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|--------|------------|
| **–§—Ä–µ–π–º–≤–æ—Ä–∫** | FastAPI | 0.104.1 | Async –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ |
| **ASGI –°–µ—Ä–≤–µ—Ä** | Uvicorn | 0.24.0 | Production ASGI —Å–µ—Ä–≤–µ—Ä |
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** | PostgreSQL | 15+ | –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –°–£–ë–î |
| **ORM** | SQLAlchemy | 2.0.23 | Async ORM |
| **–î—Ä–∞–π–≤–µ—Ä –ë–î** | asyncpg | 0.29.0 | Async PostgreSQL –¥—Ä–∞–π–≤–µ—Ä |
| **–ú–∏–≥—Ä–∞—Ü–∏–∏** | Alembic | 1.12.1 | –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î |
| **–í–∞–ª–∏–¥–∞—Ü–∏—è** | Pydantic | 2.5.0 | –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ö–µ–º—ã |
| **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** | Pydantic Settings | 2.1.0 | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π |
| **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** | python-jose | 3.3.0 | JWT —Ç–æ–∫–µ–Ω—ã |
| **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** | bcrypt | 4.1.1 | –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π |
| **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | pytest | 7.4.3 | –§—Ä–µ–π–º–≤–æ—Ä–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è |
| **Async —Ç–µ—Å—Ç—ã** | pytest-asyncio | 0.21.1 | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ async —Ç–µ—Å—Ç–æ–≤ |
| **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞** | pytest-cov | 4.1.0 | –ê–Ω–∞–ª–∏–∑ –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏ |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤** | mypy | 1.7.0 | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è |
| **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | black | 23.11.0 | –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ |
| **–õ–∏–Ω—Ç–µ—Ä** | ruff | 0.1.6 | –ë—ã—Å—Ç—Ä—ã–π –ª–∏–Ω—Ç–µ—Ä |
| **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤** | isort | 5.12.0 | –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏–º–ø–æ—Ä—Ç–æ–≤ |
| **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** | Docker + Compose | latest | –ò–∑–æ–ª—è—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è |

---

## üìö API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

#### POST `/api/v1/auth/register`
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "email": "user@example.com",
  "password": "SecurePass123",
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "organization_name": "–ú–æ—è –∫–æ–º–ø–∞–Ω–∏—è"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "user": {
    "id": "uuid",
    "email": "user@example.com",
    "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"
  },
  "organization": {
    "id": "uuid",
    "name": "–ú–æ—è –∫–æ–º–ø–∞–Ω–∏—è"
  }
}
```

#### POST `/api/v1/auth/login`
–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–æ–≤.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "email": "user@example.com",
  "password": "SecurePass123"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "access_token": "eyJ...",
  "refresh_token": "eyJ...",
  "token_type": "bearer"
}
```

#### POST `/api/v1/auth/refresh`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞ —Å –ø–æ–º–æ—â—å—é refresh —Ç–æ–∫–µ–Ω–∞.

### –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

#### GET `/api/v1/organizations/me`
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
- `Authorization: Bearer <access_token>`

### –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–ë–∞–∑–æ–≤—ã–π URL:** `/api/v1/contacts`

#### GET `/api/v1/contacts`
–°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Å –ø–æ–∏—Å–∫–æ–º –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` (int, default=1)
- `page_size` (int, max=100)
- `search` (–ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏/email)
- `owner_id` (—Ñ–∏–ª—å—Ç—Ä –ø–æ –≤–ª–∞–¥–µ–ª—å—Ü—É, –¥–ª—è manager+)

#### POST `/api/v1/contacts`
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "name": "–ê–ª–µ–∫—Å–µ–π –ü–µ—Ç—Ä–æ–≤",
  "email": "alexey@example.com",
  "phone": "+79161234567"
}
```

#### GET `/api/v1/contacts/{id}`
–ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞.

#### PUT `/api/v1/contacts/{id}`
–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç.

#### DELETE `/api/v1/contacts/{id}`
–£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å–¥–µ–ª–æ–∫).

### –°–¥–µ–ª–∫–∏

**–ë–∞–∑–æ–≤—ã–π URL:** `/api/v1/deals`

#### GET `/api/v1/deals`
–°–ø–∏—Å–æ–∫ —Å–¥–µ–ª–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page`, `page_size`
- `status` (–º–∞—Å—Å–∏–≤: `status=new&status=in_progress`)
- `min_amount`, `max_amount`
- `stage` (—Å—Ç–∞–¥–∏—è –≤–æ—Ä–æ–Ω–∫–∏)
- `owner_id` (–¥–ª—è —Ä–æ–ª–µ–π –≤—ã—à–µ member)
- `order_by` (–ø–æ–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏: `created_at`, `amount`)
- `order` (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: `asc`, `desc`)

#### POST `/api/v1/deals`
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å–¥–µ–ª–∫—É.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "contact_id": "uuid",
  "title": "–†–µ–¥–∏–∑–∞–π–Ω —Å–∞–π—Ç–∞",
  "amount": 150000.0,
  "currency": "RUB",
  "stage": "qualification"
}
```

#### GET `/api/v1/deals/{id}`
–ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ —Å–¥–µ–ª–∫–∏.

#### PATCH `/api/v1/deals/{id}`
–ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "status": "won",
  "stage": "closed",
  "amount": 180000.0
}
```

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞:**
- –ü—Ä–∏ `status="won"` ‚Üí `amount > 0`, –∏–Ω–∞—á–µ 400
- –û—Ç–∫–∞—Ç —Å—Ç–∞–¥–∏–∏ –Ω–∞–∑–∞–¥ –∑–∞–ø—Ä–µ—â–µ–Ω –¥–ª—è —Ä–æ–ª–∏ member
- –ü—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è Activity

#### DELETE `/api/v1/deals/{id}`
–£–¥–∞–ª–∏—Ç—å —Å–¥–µ–ª–∫—É.

### –ó–∞–¥–∞—á–∏

**–ë–∞–∑–æ–≤—ã–π URL:** `/api/v1/tasks`

#### GET `/api/v1/tasks`
–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `deal_id` (—Ñ–∏–ª—å—Ç—Ä –ø–æ —Å–¥–µ–ª–∫–µ)
- `only_open` (bool, —Ç–æ–ª—å–∫–æ –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ)
- `due_before`, `due_after` (—Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ä–æ–∫–∞–º)

#### POST `/api/v1/tasks`
–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "deal_id": "uuid",
  "title": "–ü–æ–∑–≤–æ–Ω–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É",
  "description": "–û–±—Å—É–¥–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è",
  "due_date": "2025-01-15"
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `due_date` –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –ø—Ä–æ—à–ª–æ–º
- `deal_id` –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å —Ç–µ–∫—É—â–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- –î–ª—è member - —Å–¥–µ–ª–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

#### GET `/api/v1/tasks/{id}`
–ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏.

#### PATCH `/api/v1/tasks/{id}`
–û–±–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é).

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "is_done": true
}
```

#### DELETE `/api/v1/tasks/{id}`
–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É.

### –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (—Ç–∞–π–º–ª–∞–π–Ω)

**–ë–∞–∑–æ–≤—ã–π URL:** `/api/v1/deals/{deal_id}/activities`

#### GET `/api/v1/deals/{deal_id}/activities`
–ü–æ–ª—É—á–∏—Ç—å —Ç–∞–π–º–ª–∞–π–Ω –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ —Å–¥–µ–ª–∫–µ.

#### POST `/api/v1/deals/{deal_id}/activities`
–°–æ–∑–¥–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (—Ç–æ–ª—å–∫–æ `type="comment"`).

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "type": "comment",
  "payload": {
    "text": "–ö–ª–∏–µ–Ω—Ç –ø–æ–ø—Ä–æ—Å–∏–ª –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ"
  }
}
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞, —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á) —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

#### GET `/api/v1/analytics/deals/summary`
–°–≤–æ–¥–∫–∞ –ø–æ —Å–¥–µ–ª–∫–∞–º —Ç–µ–∫—É—â–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.

**–û—Ç–≤–µ—Ç:**
```json
{
  "by_status": {
    "new": {"count": 15, "total_amount": 500000.0},
    "in_progress": {"count": 8, "total_amount": 350000.0},
    "won": {"count": 23, "total_amount": 1200000.0},
    "lost": {"count": 5, "total_amount": 150000.0}
  },
  "average_won_amount": 52173.91,
  "new_deals_last_30_days": 12
}
```

#### GET `/api/v1/analytics/deals/funnel`
–í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ —Å –∫–æ–Ω–≤–µ—Ä—Å–∏–µ–π.

**–û—Ç–≤–µ—Ç:**
```json
{
  "funnel": [
    {
      "stage": "qualification",
      "count": 25,
      "by_status": {"new": 15, "in_progress": 8, "won": 2},
      "conversion_rate": 100.0
    },
    {
      "stage": "proposal",
      "count": 18,
      "by_status": {"in_progress": 12, "won": 5, "lost": 1},
      "conversion_rate": 72.0
    }
  ]
}
```

### –§–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫

–í—Å–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –µ–¥–∏–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```json
{
  "detail": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
  "code": "ERROR_CODE"
}
```

**–ö–æ–¥—ã –æ—à–∏–±–æ–∫:**
- `400` - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (ValidationError)
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω (Unauthorized)
- `403` - –ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (Forbidden)
- `404` - –ù–µ –Ω–∞–π–¥–µ–Ω–æ (Not Found)
- `409` - –ö–æ–Ω—Ñ–ª–∏–∫—Ç (Conflict, –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ —Å–¥–µ–ª–∫–∞–º–∏)
- `422` - –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö (Unprocessable Entity)

---

## üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```
mini-crm-ai-gen/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ v1/                    # API v1 —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py           # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ organizations.py  # –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ contacts.py       # –ö–æ–Ω—Ç–∞–∫—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deals.py          # –°–¥–µ–ª–∫–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks.py          # –ó–∞–¥–∞—á–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ activities.py     # –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analytics.py      # –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dependencies.py       # FastAPI –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ middleware.py         # Middleware (CORS, errors)
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py           # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î (async engine)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.py           # –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt.py                # JWT —Ç–æ–∫–µ–Ω—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cache.py              # In-memory –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ permissions.py        # RBAC —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ exceptions.py         # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ models/                   # SQLAlchemy ORM –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ organization.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ contact.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deal.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ activity.py
‚îÇ   ‚îú‚îÄ‚îÄ repositories/             # Data Access Layer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py              # –ë–∞–∑–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ organization.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ contact.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deal.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ activity.py
‚îÇ   ‚îú‚îÄ‚îÄ schemas/                  # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ organization.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ contact.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deal.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ activity.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analytics.py
‚îÇ   ‚îú‚îÄ‚îÄ services/                 # Business Logic Layer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py              # –°–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ organization.py      # –°–µ—Ä–≤–∏—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ contact.py           # –°–µ—Ä–≤–∏—Å –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deal.py              # –°–µ—Ä–≤–∏—Å —Å–¥–µ–ª–æ–∫ (—Å –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞–º–∏)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task.py              # –°–µ—Ä–≤–∏—Å –∑–∞–¥–∞—á
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ activity.py          # –°–µ—Ä–≤–∏—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analytics.py         # –°–µ—Ä–≤–∏—Å –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ main.py                   # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ migrations/                   # Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ versions/                # –ò—Å—Ç–æ—Ä–∏—è –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ env.py                   # Alembic –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ tests/                        # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ unit/                    # Unit —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ integration/             # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py              # Pytest —Ñ–∏–∫—Å—Ç—É—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ test_*.py
‚îú‚îÄ‚îÄ docker/                       # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ docs/                         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ .env.example                  # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt              # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ docker-compose.yml            # Docker Compose –∫–æ–Ω—Ñ–∏–≥
‚îú‚îÄ‚îÄ docker-compose.test.yml       # –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ alembic.ini                   # Alembic –∫–æ–Ω—Ñ–∏–≥
‚îú‚îÄ‚îÄ pyproject.toml                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
‚îî‚îÄ‚îÄ README.md                     # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –°–ª–æ–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
graph TD
    A[API Layer - FastAPI] -->|Schemas, Dependencies| B[Service Layer - Business Logic]
    B -->|RBAC, Validations| C[Repository Layer - Data Access]
    C -->|SQLAlchemy ORM| D[Database - PostgreSQL 15+]

    style A fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    style B fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    style C fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px
    style D fill:#fff3e0,stroke:#e65100,stroke-width:2px
```

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**
- ‚úÖ –°–ª–æ–∏ –Ω–µ —Å–º–µ—à–∏–≤–∞—é—Ç—Å—è
- ‚úÖ –ö–∞–∂–¥—ã–π —Å–ª–æ–π –∏–º–µ–µ—Ç —á–µ—Ç–∫—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
- ‚úÖ Dependency Injection —á–µ—Ä–µ–∑ FastAPI
- ‚úÖ –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è (–º–æ–∂–Ω–æ –º–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ª—é–±–æ–π —Å–ª–æ–π)

---

## üóÑÔ∏è –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

#### `users` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
```sql
id              UUID PRIMARY KEY
email           VARCHAR UNIQUE NOT NULL
hashed_password VARCHAR NOT NULL
name            VARCHAR NOT NULL
created_at      TIMESTAMP
```

#### `organizations` - –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
```sql
id         UUID PRIMARY KEY
name       VARCHAR NOT NULL
created_at TIMESTAMP
```

#### `organization_members` - –£—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
```sql
id              UUID PRIMARY KEY
organization_id UUID REFERENCES organizations
user_id         UUID REFERENCES users
role            VARCHAR (owner, admin, manager, member)
created_at      TIMESTAMP
UNIQUE(organization_id, user_id)
```

#### `contacts` - –ö–æ–Ω—Ç–∞–∫—Ç—ã
```sql
id              UUID PRIMARY KEY
organization_id UUID REFERENCES organizations
owner_id        UUID REFERENCES users
name            VARCHAR NOT NULL
email           VARCHAR
phone           VARCHAR
created_at      TIMESTAMP
```

#### `deals` - –°–¥–µ–ª–∫–∏
```sql
id              UUID PRIMARY KEY
organization_id UUID REFERENCES organizations
contact_id      UUID REFERENCES contacts
owner_id        UUID REFERENCES users
title           VARCHAR NOT NULL
amount          DECIMAL(15,2) NOT NULL
currency        VARCHAR DEFAULT 'USD'
status          VARCHAR DEFAULT 'new'
stage           VARCHAR DEFAULT 'qualification'
created_at      TIMESTAMP
updated_at      TIMESTAMP
```

#### `tasks` - –ó–∞–¥–∞—á–∏
```sql
id          UUID PRIMARY KEY
deal_id     UUID REFERENCES deals
title       VARCHAR NOT NULL
description TEXT
due_date    DATE NOT NULL
is_done     BOOLEAN DEFAULT FALSE
created_at  TIMESTAMP
```

#### `activities` - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
```sql
id         UUID PRIMARY KEY
deal_id    UUID REFERENCES deals
author_id  UUID REFERENCES users (nullable)
type       VARCHAR NOT NULL
payload    JSONB
created_at TIMESTAMP
```

### –°–≤—è–∑–∏

```
organizations ‚îÄ‚îÄ‚î¨‚îÄ< contacts
                ‚îú‚îÄ< deals
                ‚îî‚îÄ< organization_members ‚îÄ< users

contacts ‚îÄ‚îÄ< deals ‚îÄ‚îÄ‚î¨‚îÄ< tasks
                     ‚îî‚îÄ< activities
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã

<table>
<tr>
<td width="33%">

**üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**

‚úÖ Bcrypt —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
‚úÖ JWT —Ç–æ–∫–µ–Ω—ã (access/refresh)
‚úÖ –ü–æ–¥–ø–∏—Å—å —Å SECRET_KEY
‚úÖ Access: 15 –º–∏–Ω—É—Ç
‚úÖ Refresh: 7 –¥–Ω–µ–π

</td>
<td width="33%">

**üè¢ Multi-tenancy**

‚úÖ –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ organization_id
‚úÖ RBAC —Å 4 —É—Ä–æ–≤–Ω—è–º–∏ —Ä–æ–ª–µ–π
‚úÖ –ì—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö

</td>
<td width="33%">

**üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö**

‚úÖ Pydantic –≤–∞–ª–∏–¥–∞—Ü–∏—è
‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π
‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
‚úÖ CORS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

</td>
</tr>
</table>

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production

> ‚ö†Ô∏è **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é:**

- üîë –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∏–ª—å–Ω—ã–π `SECRET_KEY` (32+ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–∏–º–≤–æ–ª–∞)
- üîí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSL/TLS –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ë–î
- üåê –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `CORS_ORIGINS` —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
- üîê –í–∫–ª—é—á–∏—Ç—å HTTPS –¥–ª—è API
- üö¶ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å rate limiting
- üíæ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã –ë–î
- üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ unit/                          # Unit —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ test_models.py            # –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ test_services.py          # –¢–µ—Å—Ç—ã –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ test_permissions.py       # –¢–µ—Å—Ç—ã RBAC
‚îú‚îÄ‚îÄ integration/                   # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ test_auth_api.py          # –¢–µ—Å—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ test_contacts_api.py      # –¢–µ—Å—Ç—ã API –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ test_deals_api.py         # –¢–µ—Å—Ç—ã API —Å–¥–µ–ª–æ–∫
‚îÇ   ‚îî‚îÄ‚îÄ test_full_scenario_e2e.py # E2E —Ç–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ conftest.py                    # Pytest —Ñ–∏–∫—Å—Ç—É—Ä—ã
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
pytest

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
pytest --cov=app --cov-report=term-missing

# –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
pytest tests/unit/

# –¢–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ
pytest tests/integration/

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
pytest tests/unit/test_models.py

# –° –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
pytest -v

# –° –≤—ã–≤–æ–¥–æ–º print
pytest -s

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
pytest -x
```

### Docker-—Ç–µ—Å—Ç—ã

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏
docker-compose -f docker-compose.test.yml up --build --abort-on-container-exit

# –¢–æ–ª—å–∫–æ —Å–±–æ—Ä–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞
docker-compose -f docker-compose.test.yml build

# –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤
docker-compose -f docker-compose.test.yml down -v
```

### –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

**Unit —Ç–µ—Å—Ç—ã** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª (–ø—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ —Å—Ç–∞—Ç—É—Å–æ–≤, —Ä–æ–ª–µ–π)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –õ–æ–≥–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API:
- HTTP –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ TestClient
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å-–∫–æ–¥–æ–≤ –∏ —Ñ–æ—Ä–º–∞—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ RBAC –Ω–∞ —É—Ä–æ–≤–Ω–µ API

**E2E —Ç–µ—Å—Ç—ã** - –ø–æ–ª–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
4. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
5. –°–æ–∑–¥–∞–Ω–∏–µ —Å–¥–µ–ª–æ–∫
6. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á
7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

---

## üé® –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ –∏ –ª–∏–Ω—Ç–µ—Ä—ã

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –≤ `pyproject.toml`.

### MyPy - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–µ–∫—Ç
mypy app/

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–æ–¥—É–ª—å
mypy app/services/

# –° –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º –æ—à–∏–±–æ–∫
mypy --show-error-codes app/

# –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–º–ø–æ—Ä—Ç—ã
mypy --ignore-missing-imports app/
```

### Black - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

```bash
# –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã
black app/ tests/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
black --check app/

# –ü–æ–∫–∞–∑–∞—Ç—å diff
black --diff app/

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
black app/main.py
```

### Ruff - –±—ã—Å—Ç—Ä—ã–π –ª–∏–Ω—Ç–µ—Ä

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
ruff check app/

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
ruff check --fix app/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª (E=errors, F=pyflakes, I=isort)
ruff check --select E,F,I app/

# –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
ruff check --ignore E501 app/
```

### isort - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤

```bash
# –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç—ã
isort app/ tests/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
isort --check-only app/

# –ü–æ–∫–∞–∑–∞—Ç—å diff
isort --diff app/

# –° –ø—Ä–æ—Ñ–∏–ª–µ–º black (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
isort --profile black app/
```

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫

```bash
# –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
mypy app/ && \
ruff check app/ && \
black --check app/ && \
isort --check-only app/ && \
pytest --cov=app

# –ò–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
chmod +x scripts/check_quality.sh
./scripts/check_quality.sh
```

### Pre-commit hook

–°–æ–∑–¥–∞–π—Ç–µ `.git/hooks/pre-commit` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º:

```bash
#!/bin/bash
set -e

echo "üîç –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞..."

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
echo "üìù –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞..."
black app/ tests/
isort app/ tests/

# –õ–∏–Ω—Ç–∏–Ω–≥
echo "üîé –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–æ–º..."
ruff check --fix app/

# –¢–∏–ø—ã
echo "üî¨ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤..."
mypy app/

# –¢–µ—Å—Ç—ã
echo "üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤..."
pytest

echo "‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã!"
```

–°–¥–µ–ª–∞–π—Ç–µ –µ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:
```bash
chmod +x .git/hooks/pre-commit
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `pyproject.toml`:

```toml
[tool.black]
line-length = 100
target-version = ['py311']

[tool.isort]
profile = "black"
line_length = 100

[tool.mypy]
python_version = "3.11"
strict = true
warn_return_any = true

[tool.ruff]
line-length = 100
target-version = "py311"
```

---

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (Deployment)

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è production

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª —Å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

```env
# === –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ===
DATABASE_URL=postgresql+asyncpg://user:password@host:5432/dbname
POSTGRES_USER=crm_user
POSTGRES_PASSWORD=very-strong-password-here
POSTGRES_DB=crm_production

# === –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ===
SECRET_KEY=your-production-secret-key-min-32-chars-random-string
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7

# === –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ===
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO
PROJECT_NAME=CRM API

# === CORS ===
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ JSON –º–∞—Å—Å–∏–≤ –¥–ª—è Pydantic Settings 2.x
CORS_ORIGINS=["https://your-frontend.com","https://app.yourdomain.com"]

# === –î—Ä—É–≥–æ–µ ===
SUPPORTED_CURRENCIES=["USD","EUR","RUB"]
CACHE_DEFAULT_TTL=300
```

### Production Checklist

<details>
<summary><b>üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º (–∫–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è —Ä–∞—Å–∫—Ä—ã—Ç–∏—è)</b></summary>

<br>

**üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å–∏–ª—å–Ω—ã–π `SECRET_KEY` (32+ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–∏–º–≤–æ–ª–∞)
- [ ] `DEBUG=false` (–æ—Ç–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏)
- [ ] –í–∫–ª—é—á–µ–Ω SSL/TLS –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å PostgreSQL
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã `CORS_ORIGINS` —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω HTTPS (Let's Encrypt/—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω rate limiting (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ nginx)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω firewall

**üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω `DATABASE_URL` —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω connection pooling –¥–ª—è –ë–î
- [ ] –ü—Ä–∏–º–µ–Ω–µ–Ω—ã –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (`alembic upgrade head`)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –ë–î

**üîß –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω reverse proxy (nginx/traefik)
- [ ] `LOG_LEVEL=INFO` –∏–ª–∏ `WARNING`
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (ELK, Grafana Loki)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus, Grafana)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–ª–µ—Ä—Ç—ã (alertmanager)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω health check endpoint

</details>

### Docker Production

–î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Dockerfile:

```dockerfile
FROM python:3.11-slim

WORKDIR /app

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
COPY app/ app/
COPY alembic.ini .
COPY migrations/ migrations/

# –ù–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—Ç root
RUN useradd -m appuser
USER appuser

# Healthcheck
HEALTHCHECK --interval=30s --timeout=10s --retries=3 \
  CMD curl -f http://localhost:8000/health || exit 1

# –ó–∞–ø—É—Å–∫ —Å Gunicorn + Uvicorn workers
CMD ["gunicorn", "app.main:app", \
     "--worker-class", "uvicorn.workers.UvicornWorker", \
     "--workers", "4", \
     "--bind", "0.0.0.0:8000", \
     "--access-logfile", "-", \
     "--error-logfile", "-"]
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–î–æ–±–∞–≤—å—Ç–µ health check endpoint –≤ `app/main.py`:

```python
@app.get("/health")
async def health_check():
    return {
        "status": "healthy",
        "timestamp": datetime.utcnow().isoformat()
    }
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤ production

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é
alembic current

# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ –º–∏–≥—Ä–∞—Ü–∏–π
alembic history

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head

# –û—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ –æ–¥–Ω—É –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞–∑–∞–¥
alembic downgrade -1

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
alembic revision --autogenerate -m "Description"
```

---

## üìñ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

<details>
<summary><b>1. üîê –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</b></summary>

<br>

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```bash
curl -X POST "http://localhost:8000/api/v1/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "ivan@example.com",
    "password": "SecurePass123",
    "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
    "organization_name": "–û–û–û –†–æ–≥–∞ –∏ –ö–æ–ø—ã—Ç–∞"
  }'
```

**–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É:**
```bash
curl -X POST "http://localhost:8000/api/v1/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "ivan@example.com",
    "password": "SecurePass123"
  }'
```

> üí° **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ** `access_token` –∏–∑ –æ—Ç–≤–µ—Ç–∞: `TOKEN="eyJhbGc..."`

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:**
```bash
curl -X POST "http://localhost:8000/api/v1/auth/refresh" \
  -H "Content-Type: application/json" \
  -d '{
    "refresh_token": "YOUR_REFRESH_TOKEN"
  }'
```

</details>

### 2. –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏

```bash
# –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç
curl -X POST "http://localhost:8000/api/v1/contacts" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤",
    "email": "alexey@client.com",
    "phone": "+79161234567"
  }'

# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
curl -X GET "http://localhost:8000/api/v1/contacts?page=1&page_size=20" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID"

# –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
curl -X GET "http://localhost:8000/api/v1/contacts?search=–ê–ª–µ–∫—Å–µ–π" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID"

# –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç –ø–æ ID
curl -X GET "http://localhost:8000/api/v1/contacts/CONTACT_UUID" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID"

# –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç
curl -X PUT "http://localhost:8000/api/v1/contacts/CONTACT_UUID" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤",
    "email": "new@email.com",
    "phone": "+79167654321"
  }'

# –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç
curl -X DELETE "http://localhost:8000/api/v1/contacts/CONTACT_UUID" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID"
```

### 3. –†–∞–±–æ—Ç–∞ —Å–æ —Å–¥–µ–ª–∫–∞–º–∏

```bash
# –°–æ–∑–¥–∞—Ç—å —Å–¥–µ–ª–∫—É
curl -X POST "http://localhost:8000/api/v1/deals" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID" \
  -H "Content-Type: application/json" \
  -d '{
    "contact_id": "CONTACT_UUID",
    "title": "–ü–æ—Å—Ç–∞–≤–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è",
    "amount": 500000.00,
    "currency": "RUB",
    "stage": "qualification"
  }'

# –°–ø–∏—Å–æ–∫ —Å–¥–µ–ª–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
curl -X GET "http://localhost:8000/api/v1/deals?status=in_progress&min_amount=100000&order_by=amount&order=desc" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID"

# –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–¥–µ–ª–∫–∏
curl -X PATCH "http://localhost:8000/api/v1/deals/DEAL_UUID" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID" \
  -H "Content-Type: application/json" \
  -d '{
    "status": "won",
    "stage": "closed"
  }'
```

### 4. –†–∞–±–æ—Ç–∞ —Å –∑–∞–¥–∞—á–∞–º–∏

```bash
# –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
curl -X POST "http://localhost:8000/api/v1/tasks" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID" \
  -H "Content-Type: application/json" \
  -d '{
    "deal_id": "DEAL_UUID",
    "title": "–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ",
    "description": "–í–∫–ª—é—á–∏—Ç—å —Ü–µ–Ω—ã –∏ —É—Å–ª–æ–≤–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏",
    "due_date": "2025-02-01"
  }'

# –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –ø–æ —Å–¥–µ–ª–∫–µ
curl -X GET "http://localhost:8000/api/v1/tasks?deal_id=DEAL_UUID&only_open=true" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID"

# –û—Ç–º–µ—Ç–∏—Ç—å –∑–∞–¥–∞—á—É –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é
curl -X PATCH "http://localhost:8000/api/v1/tasks/TASK_UUID" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID" \
  -H "Content-Type: application/json" \
  -d '{
    "is_done": true
  }'
```

### 5. –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Ç–∞–π–º–ª–∞–π–Ω

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Ç–∞–π–º–ª–∞–π–Ω —Å–¥–µ–ª–∫–∏
curl -X GET "http://localhost:8000/api/v1/deals/DEAL_UUID/activities" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID"

# –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
curl -X POST "http://localhost:8000/api/v1/deals/DEAL_UUID/activities" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID" \
  -H "Content-Type: application/json" \
  -d '{
    "type": "comment",
    "payload": {
      "text": "–ö–ª–∏–µ–Ω—Ç —Å–æ–≥–ª–∞—Å–µ–Ω —Å —É—Å–ª–æ–≤–∏—è–º–∏, –∂–¥–µ–º –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞"
    }
  }'
```

### 6. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

```bash
# –°–≤–æ–¥–∫–∞ –ø–æ —Å–¥–µ–ª–∫–∞–º
curl -X GET "http://localhost:8000/api/v1/analytics/deals/summary" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID"

# –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂
curl -X GET "http://localhost:8000/api/v1/analytics/deals/funnel" \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Organization-Id: YOUR_ORG_ID"
```

---

## ü§ù –£—á–∞—Å—Ç–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

### Workflow

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
   ```bash
   git checkout -b feature/amazing-feature
   ```
3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
   ```bash
   black app/ tests/
   ruff check --fix app/
   mypy app/
   pytest
   ```
5. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
   ```bash
   git commit -m 'feat: Add amazing feature'
   ```
6. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ —É–¥–∞–ª–µ–Ω–Ω—É—é –≤–µ—Ç–∫—É
   ```bash
   git push origin feature/amazing-feature
   ```
7. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

### –°—Ç–∏–ª—å –∫–æ–º–º–∏—Ç–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [Conventional Commits](https://www.conventionalcommits.org/):

- `feat:` - –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- `fix:` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞
- `docs:` - –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- `style:` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- `refactor:` - —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
- `test:` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
- `chore:` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### Code Review

Pull requests –¥–æ–ª–∂–Ω—ã:
- –ü—Ä–æ—Ö–æ–¥–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
- –ò–º–µ—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—Ç–∏–ª—é –∫–æ–¥–∞ (black, ruff)
- –ò–º–µ—Ç—å type hints (–ø—Ä–æ–≤–µ—Ä–∫–∞ mypy)
- –°–æ–¥–µ—Ä–∂–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT License.

---

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- –ü–æ—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–µ [FastAPI](https://fastapi.tiangolo.com/)
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ [PostgreSQL](https://www.postgresql.org/)
- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é [Claude Code](https://claude.com/claude-code)

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:
- –°–æ–∑–¥–∞–π—Ç–µ [Issue](../../issues) –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- –û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π](docs/)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [–ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#-–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-api)

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –≠—Ç–æ production-ready CRM —Å–∏—Å—Ç–µ–º–∞ —Å enterprise-—É—Ä–æ–≤–Ω–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. –ü–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º –≤ production –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–ª–µ–¥—É–π—Ç–µ [—á–µ–∫–ª–∏—Å—Ç—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#production-checklist) –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≤—Å–µ [–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è-–¥–ª—è-production).
